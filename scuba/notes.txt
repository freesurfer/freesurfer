
test_ScubaLayers
x report info at RAS
 x set label properly
 x ScubaView not drawing last character


x main scuba interface window
x fix file selectors
x make load volume dlog nice
x fix crash on load volume without redraw
x error dialogs
x frame->view config
x make label/value display panel
x fix overlay drawing bugs

x b/c, LUT color map support
x opacity

x label/value display panel

x Layer Info interface
x - change b/c or LUT
x - change opactiy

x replace mbClearZero with min/max

x View Props panel
x  - menu of views
x  - draw level slots, each with menu of layers

x ScubaView:
x key down
x  - left right down up in out zoom inplane

x ScubaLayer2DMRIS.cpp
x layer factory stuff
x  - surface color
x  - draw with opacity
x - line drawing
 - line width
 - antialiased line drawing

cursor linking
x - Set2DRASCenter, Set2DZoomLevel
x - each ScubaView has a linked flag, settable in view props panel
x - SetLinkedFlag in ScubaView, adds id to static list
x - when link functions called, goes through linked list and calls the same
x - Copy These Layers to Current Views button in views props, copies layer/level settings to other views, tcl function takes list of view IDs

ScubaToolState
x  - registers tcl functions for getting and setting stuff (with id)
 - tool: { navigation, marker, voxel paint, voxel clone, voxel selection, voxel restore, control points }
x  - brush : radius, 3d, shape
 - voxel paint : min/max, new value
 - voxel clone : min/max, source

x ScubaFrame gets a ScubaToolState, tcl function for getting tool ID
x scuba.tcl makes gaTool(id,...), gets id from frame=gaFrame(id,toolID)
x View adds ScubaToolState to its mouse/key events, ScubaFrame passes
x View calls Layer::HandleTool ( RAS, ToolState, InputState )


x - should set,get,min/max stuff be in VolumeCollection? Layer is doing a lot of stuff

x display transform interface on view level
x - ScubaTransform class
x   - GetTransformList -- returns list of IDs
x   - Get/SetTransformLabel, Get/SetTransformMatrix
x - transforms panel
x   - list of transforms
  - two matrix displays, one is 'current', one is 'apply'
  - can load from external file or set values automatically in apply transform
  - 'apply' button on apply side multiples new matrix to current
x - view props has a new transform field
x - ScubaView gets new tcl functions:
x   - SetViewTransformID and GetViewTransformID <viewID> <transformID>

x Broadcaster class
x  - Broadcast( string message, void* data )
x  - AddListener( Listener* )
x  - RemoveListener( Listener* )
x Listener class
x  - ListenToMessage( string message, void* data )

x option for left/right flip, i.e. Neurology View, which does a x flip in R and S views
x  - make static for all views??
 - add function for getting initial values of global menu and toolbar vars i.e. gaView(flipLeftRight)

x move some key funcs to tcl
x  - gaView(current,inPlane) - get prefs from file, do key binding in MakeScubaFrame


x ScubaGlobalPrefs object with static getter
x  - on ctor, gets stuff from prefs file
x  - ScubaView gets R/L flip bool from here
 - modify PreferencesManager to have PreferencesUsers class, others mix in, have SavePrerferences() call that clientes use to set prefs before file is saved

x ScubaView needs to use TranslateWindowToRAS when drawing coords on side of window


x ScubaLUT
x  - ScubaLUT with normal GetIDList, etc, wrapper for colortab.c
x  - index<->color functions
x  - change 2DMRILayer to take LUT id instead of filename
x  - button for loading LUT

x LUT panel
x  - settable label
x  - filename
 - text field with their contents

x Collection panel
x  - ID and type
x  - editable label
 - cb for selectable
x  - type specific frame for filenames

x ScubaROI
x  - normal GetROIIdList interface, etc
x  - type: structure or free
x  - int structure
x  - int lutID
x  - int color[3]

x ScubaROIVolume
x  - SetROIBounds( iBounds[3] );
x    - ROI allocates array
x  - Select/Unselect

x DataCollection
x  - int NewROI(), calls DoNewROI, adds to map, returns ID
x  - virtual DoNewROI makes, sets up, returns 
x  - SelectROI(roiID) - checks if ID is in map, selects it
x  - Tcl NewCollectionROI
x  - Tcl SelectCollectionROI
x  - Tcl GetROIIDListForCollection

x VolumeDataCollection
x  - bool IsRASSelected()
x  - Un/SelectRAS functions called by Layer


x Collection panel
x  - ROI pane
x    - list of collection's ROIs - SelectCollectionROI colID roiID
x    - free/structure rb - SetROIType roiID strucutre|free
x    - LUT pdm
x    - structure pdm - SetROIType roiID structure, SetROIStructure roiID strctr
x    - color picker - SetROIType roiID free, SetROIColor roiID red green blue
x    - New button - MakeNewROI colID, select it

x - ScubaLayer2DMRI
x   - VolumeCollection::IsRASSelected needs to check all ROIs, return the color
x     - if multiple selections, blend colors
x   - in DrawIntoBuffer, get color of ROI and do blending
x   - selection opacity 


x line tool
x  - new tool
x  - mouse 1 down to begin, mouse up to end
x    - try rubber band updating
x  - keep list of line objects
x  - draw line with voxel line drawing
x  - function to determine if RAS coordinate is in plane with granularity
  - mouse 2 to select 
    - can hit delete to erase line

x lines
x  - volume collection has edge volume
x  - MarkRASEdge(), UnmarkRASEdge(), IsRASEdge()
x  - move line drawing code to FindPointsOnLine() in Utilities.cpp
x  - ScubaLayer2DMRI calls FindPoitnsOnLine with DrawPixel() to draw its lines
x  - ScubaLayer2DMRI calls FindPoitnsOnLine() to add points to edges
x  - when fill, check that volume for stopping
x  - only stop on _other_ ROIs
x  - cancel dlog

x Dlog boxes
x  - C interface
x    - NewDialogBox( title, text, bMeter, button1, button2 )
x    - UpdateDlog( percent )
x    - CheckDlogForButton()
x    - CloseDlog
x  - proc NewDialogBox, UpdateDlog, CheckDlogForButton, CloseDlog

x tool settings panel
x  - radius, shape, 3d
x  - tool specific panels
x    - roi: stop params (roi, lines), fuzziness

x Brush size
x  - VolumeCollection::GetRASPointsInSphere ( center, radius, bx, by, bz )
x  - VolumeCollection::GetRASPointsInCube ( center, radius, bx, by, bz )
x  - ScubaLayer gets list of points and then calls function on each
x    - Start at center, calc bounds using pixel size

Volume Edit
 - interface for setting new color and threshold
 - make button 2 like select code in ScubaLayer2DMRI
 - make an 'restore value' volume that VolumeCollection makes when loading MRI
 - button 3 will 'restore' values

x Undo
x  - UndoManager::BeginAction(isTitle), EndAction(), starts and clears lists of UndoActions
x  - UndoManager::GetTitle() tcl func returns "Nothing to undo" or "Undo|Redo $isSTitle"
x  - UndoManager::AddAction( UndoAction )
x  - UndoAction is subclassable
x    - virtual UndoAction() and virtual RedoAction()
x  - UndoManager::Undo() and Redo(), calls UndoAction() and RedoAction()
x  - Declare UndoSelectAction(bSelect, RAS)

Labels
x - save .label
x   - interface
x - export structure labels as segmentations
x   - interface
x  - load label
x   - interface

x number shortcuts for brush size

in plane increment
 - different for x y z
 - when view is created, set to 1
 - when first layer 0 set, set size for each x y z


option menus for data collections in label dlogs
 - add -menu type to dlog code



- volume drawing caching
  - problem is voxel sizes, so what if we resize and align the volume so that each voxel == 1 RAS point, and then create a volume of xyz translations, map<float[3],float[3]>, so the left-side RAS coords can just be rint-ed ... this would work for voxel size < 1, but waht about > 1, maybe just a matter of fixing the bounds



BRUCE'S LIST:::

- b/c controled by mouse


BUGS:::
- fix radius in brush, it's really ugly
- tabbing when in console switches frame, disable?
- dlog box on fill still not create
  - way to suspend the redraw in the middle of the fill?
  - way to have a progress bar without a percent?
- when switch inplane, rebuild overlay


FUTURE IDEAS:::

Save Scene
 - save a script file to automatically load in data and set up view state like current one

nav tools draw onscreen sliders for feedback
 - on mouse down with right tool, draw scale bar
 - function to translate v position into modifcation value
 - start at mouse point, use expo scale towards edge for min/max values


